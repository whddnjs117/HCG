# Oracle 모범 답안

## 코드
```sql
/*
박대리(02096)과 같은 조직에 속하는 사원들의 근무년수, 근무월수, 근무일수를 조회 하시오.
-> 근무 기간 계산시 소수점 이하 버림,
-> 재직자는 현재일까지의 근무 기간 조회
-> 퇴직자는 퇴직일까지의 근무기간 조회
*/



/* 1. 길민규 수석님 모범 답안 */
SELECT T1.EMP_ID
       ,T1.EMP_NM
       ,T1.ENTER_YMD
       ,T1.RETIRE_YMD
       ,FLOOR(MONTHS_BETWEEN(NVL(TO_DATE(T1.RETIRE_YMD, 'YYYYMMDD'), SYSDATE), TO_DATE(T1.ENTER_YMD, 'YYYYMMDD')) / 12) AS SNRT_YY 
       ,FLOOR(MONTHS_BETWEEN(NVL(TO_DATE(T1.RETIRE_YMD, 'YYYYMMDD'), SYSDATE), TO_DATE(T1.ENTER_YMD, 'YYYYMMDD'))) AS SNRT_MM
       ,FLOOR(NVL(TO_DATE(T1.RETIRE_YMD, 'YYYYMMDD'), SYSDATE) - TO_DATE(T1.ENTER_YMD, 'YYYYMMDD')) AS SNRT_DD 
  FROM PA1010 T1
      ,PA1020 T2       
 WHERE T1.C_CD = '10'
   AND T2.C_CD = T1.C_CD
   AND T2.EMP_ID = T1.EMP_ID
   AND TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN T2.STA_YMD AND T2.END_YMD 
   AND T2.LAST_YN = 'Y'
   AND T2.ORG_ID = (SELECT ORG_ID --박대리에 부서조회 
                      FROM PA1020
                     WHERE C_CD = '10'
                       AND TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN STA_YMD AND END_YMD
                       AND LAST_YN = 'Y'
                       AND EMP_ID = '02096'
;


/* 2. 문선주 선임님 답안 */
SELECT *
  FROM PA1010 T1
 WHERE T1.C_CD = :C_CD
   AND T1.STAT_CD LIKE '3%'
;



SELECT T1.EMP_ID

      ,T2.ORG_ID
      ,FLOOR(F_CONTINUOUS_YMD(T1.ENTER_YMD, NVL(T1.RETIRE_YMD,TO_CHAR(SYSDATE, 'YYYYMMDD')), 'Y')) "근무년수1" 
      ,FLOOR(F_CONTINUOUS_YMD(T1.ENTER_YMD, NVL(T1.RETIRE_YMD,TO_CHAR(SYSDATE, 'YYYYMMDD')), 'M')) "근무월수1" 
      ,FLOOR(F_CONTINUOUS_YMD(T1.ENTER_YMD, NVL(T1.RETIRE_YMD,TO_CHAR(SYSDATE, 'YYYYMMDD')), 'D'))  "근무일수1"    
      ,FLOOR(MONTHS_BETWEEN(NVL(TO_DATE(T1.RETIRE_YMD), SYSDATE), TO_DATE(T1.ENTER_YMD))/12) "근무년수"
      ,FLOOR(MONTHS_BETWEEN(NVL(TO_DATE(T1.RETIRE_YMD), SYSDATE), TO_DATE(T1.ENTER_YMD))) "근무월수"
      ,FLOOR(NVL(TO_DATE(T1.RETIRE_YMD), SYSDATE) - TO_DATE(T1.ENTER_YMD)) "근속일수"
      , CASE 
                WHEN T1.STAT_CD IS NOT NULL AND T1.STAT_CD = '30' THEN FLOOR(MONTHS_BETWEEN(TO_DATE(T1.RETIRE_YMD), TO_DATE(T1.ENTER_YMD))/12)
                ELSE FLOOR(MONTHS_BETWEEN(SYSDATE, TO_DATE(T1.ENTER_YMD))/12)
           END "근무년수"
      
      ,CASE WHEN T1.RETIRE_YMD IS NULL THEN '재직'
            ELSE '퇴직'
        END "재직상태"
      ,TO_DATE(T1.ENTER_YMD) "계산시작일"
      ,NVL(TO_DATE(T1.RETIRE_YMD), SYSDATE) "계산종료일"
  FROM PA1010 T1
      ,PA1020 T2
 WHERE T1.C_CD = :C_CD
   AND T2.C_CD = T1.C_CD
   AND T2.EMP_ID = T1.EMP_ID
   AND T2.LAST_YN = 'Y'
   AND TO_CHAR(SYSDATE, 'YYYYMMDD') BETWEEN T2.STA_YMD AND T2.END_YMD
   AND T2.ORG_ID IN
           (SELECT A.ORG_ID
              FROM PA1020 A
             WHERE A.C_CD = '10'
               AND A.EMP_ID = '02096'
               AND A.LAST_YN = 'Y'
               AND TO_CHAR(SYSDATE, 'YYYYMMDD') BETWEEN A.STA_YMD AND A.END_YMD)
   
;

SELECT T1.ORG_ID
  FROM PA1020 T1
 WHERE T1.C_CD = '10'
   AND T1.EMP_ID= '02096'
   AND T1.LAST_YN = 'Y'
   AND TO_CHAR(SYSDATE, 'YYYYMMDD') BETWEEN T1.STA_YMD AND T1.END_YMD
```